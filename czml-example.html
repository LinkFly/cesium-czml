<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- Include the CesiumJS JavaScript and CSS files -->
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.78/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.78/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
</head>
<body>
<div id="cesiumContainer"></div>
<script>
  // Your access token can be found at: https://cesium.com/ion/tokens.
  //Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIxYmE2ODA5Yy1kOTQ5LTQ3ODktYjc2ZC1kM2MzODU4ZWNiYzUiLCJpZCI6Mjc5MzUsInNjb3BlcyI6WyJhc3IiLCJnYyJdLCJpYXQiOjE1OTAzOTUyMzh9.ExrLyK5nfnMfK2r-coVtvv7UFHCLVqKc_9Kyrdm4TMw';
  Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyMGRhZjhhMy03NmM3LTQ3MWYtYTg1OC1iMjU4MTMzMjM4MWUiLCJpZCI6Mjc5MzUsInNjb3BlcyI6WyJhc2wiLCJhc3IiLCJhc3ciLCJnYyIsInByIl0sImlhdCI6MTU5MDM5NTMxMn0.yfMR-MIKAS1WHrX9o0ODwmjDxtpHDf125aahm3yOPFU';
  // Initialize the Cesium Viewer in the HTML element with the `cesiumContainer` ID.
  const viewer = new Cesium.Viewer('cesiumContainer', {
    terrainProvider: Cesium.createWorldTerrain()
  });

  var scene = viewer.scene;
  var clock = viewer.clock;

  var entity;
  var positionProperty;
  var dataSourcePromise = Cesium.CzmlDataSource.load(
    "SampleData/ClampToGround.czml"
  );

  viewer.dataSources.add(dataSourcePromise).then(function (dataSource) {
    entity = dataSource.entities.getById("CesiumMilkTruck");
    positionProperty = entity.position;
  });

  viewer.camera.setView({
    destination: new Cesium.Cartesian3(
      1216403.8845586285,
      -4736357.493351395,
      4081299.715698949
    ),
    orientation: new Cesium.HeadingPitchRoll(
      4.2892217081808806,
      -0.4799070147502502,
      6.279789177843313
    ),
    endTransform: Cesium.Matrix4.IDENTITY,
  });

  ///////////////////////////////////////
  var tileset = scene.primitives.add(
    new Cesium.Cesium3DTileset({
      //url: Cesium.IonResource.fromAssetId(40866),
      url: Cesium.IonResource.fromAssetId(96188)
    })
  );

  if (scene.clampToHeightSupported) {
    tileset.initialTilesLoaded.addEventListener(start);
  } else {
    window.alert("This browser does not support clampToHeight.");
  }

  function start() {
    clock.shouldAnimate = true;
    var objectsToExclude = [entity];
    scene.postRender.addEventListener(function () {
      var position = positionProperty.getValue(clock.currentTime);
      entity.position = scene.clampToHeight(position, objectsToExclude);
    });
  }
////////////////////////////////////////////

  /////////////////////////////////////////
  // Add Cesium OSM Buildings, a global 3D buildings layer.
  //const buildingTileset = viewer.scene.primitives.add(Cesium.createOsmBuildings());
  // Fly the camera to San Francisco at the given longitude, latitude, and height.
  /*viewer.camera.flyTo({
    destination : Cesium.Cartesian3.fromDegrees(-122.4175, 37.655, 400),
    orientation : {
      heading : Cesium.Math.toRadians(0.0),
      pitch : Cesium.Math.toRadians(-15.0),
    }
  });*/
</script>
</div>
</body>
</html>

